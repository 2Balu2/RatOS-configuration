[gcode_shell_command generate_shaper_graph_x]
command: /home/pi/klipper_config/config/scripts/generate-shaper-graph-x.sh
timeout: 60.
verbose: True

[gcode_shell_command generate_shaper_graph_y]
command: /home/pi/klipper_config/config/scripts/generate-shaper-graph-y.sh
timeout: 60.
verbose: True

[gcode_macro GENERATE_SHAPER_GRAPHS]
gcode:
    {% if PARAMS.AXIS is defined %}
        {% if PARAMS.AXIS|lower == 'x' %}
            TEST_RESONANCES AXIS=X
            RUN_SHELL_COMMAND CMD=generate_shaper_graph_x
            action_respond_info("Input shaper graph generated for the X axis. You'll find it in the input_shaper folder in the machine tab!")
        {% elseif PARAMS.AXIS|lower == 'y' %}
            TEST_RESONANCES AXIS=Y
            RUN_SHELL_COMMAND CMD=generate_shaper_graph_y
            action_respond_info("Input shaper graph generated for the Y axis. You'll find it in the input_shaper folder in the machine tab!")
        {% else %}
            action_raise_error("Unknown axis specified. Expected X or Y.")
        {% endif %}
    {% else %}
        TEST_RESONANCES AXIS=X
        TEST_RESONANCES AXIS=Y
        RUN_SHELL_COMMAND CMD=generate_shaper_graph_x
        RUN_SHELL_COMMAND CMD=generate_shaper_graph_y
        action_respond_info("Input shaper graphs generated for X and Y. You'll find them in the input_shaper folder in the machine tab!")
    {% endif %}